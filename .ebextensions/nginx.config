files:
    "/etc/nginx/conf.d/proxy.conf":
        mode: "000644"
        owner: root
        group: root
        content: |
            client_max_body_size 50M;

    "/etc/nginx/conf.d/custom.conf":
        mode: "000644"
        owner: root
        group: root
        content: |
            server {
                listen 80;

                location /static/ {
                    alias /var/app/current/github.io/staticfiles_collected/;
                    expires 30d;
                    add_header Cache-Control "public, max-age=2592000";
                }

                location /media/ {
                    alias /var/app/current/github.io/media/;
                    expires 30d;
                    add_header Cache-Control "public, max-age=2592000";
                }

                location / {
                    proxy_pass http://127.0.0.1:8000;
                    proxy_set_header Host $host;
                    proxy_set_header X-Real-IP $remote_addr;
                    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                }
            }

    "/etc/nginx/conf.d/types_hash.conf":
        mode: "000644"
        owner: root
        group: root
        content: |
            types_hash_max_size 2048;

container_commands:
    01_reload_nginx:
        command: "service nginx reload"
